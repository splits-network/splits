---
phase: 10-frontend-and-search
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/portal/src/app/portal/roles/components/wizards/wizard-steps/types.ts
  - apps/portal/src/app/portal/roles/components/wizards/wizard-steps/step-2-compensation.tsx
  - apps/portal/src/app/portal/roles/components/modals/role-wizard-modal.tsx
autonomous: true

must_haves:
  truths:
    - "Job create form shows commute type checkboxes with 6 options (remote, hybrid 1-4, in office)"
    - "Job create form shows job level dropdown with 8 options (entry through c_suite)"
    - "Editing an existing job populates commute_types and job_level from API response"
    - "Submitting the form sends commute_types array and job_level string in the payload"
  artifacts:
    - path: "apps/portal/src/app/portal/roles/components/wizards/wizard-steps/types.ts"
      provides: "FormData with commute_types and job_level fields"
      contains: "commute_types"
    - path: "apps/portal/src/app/portal/roles/components/wizards/wizard-steps/step-2-compensation.tsx"
      provides: "Checkbox group for commute types, dropdown for job level"
      contains: "commute_types"
    - path: "apps/portal/src/app/portal/roles/components/modals/role-wizard-modal.tsx"
      provides: "Form state init, edit loading, reset, and payload with new fields"
      contains: "commute_types"
  key_links:
    - from: "step-2-compensation.tsx"
      to: "types.ts"
      via: "FormData interface import"
      pattern: "FormData"
    - from: "role-wizard-modal.tsx"
      to: "API payload"
      via: "payload.commute_types and payload.job_level in handleSubmit"
      pattern: "commute_types"
---

<objective>
Add commute type multi-select (checkboxes) and job level dropdown to the role wizard form.

Purpose: Users need to set commute types and job level when creating or editing jobs (UI-01, UI-02).
Output: Updated wizard Step 2 with new form controls, FormData type extended, modal state management updated.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/portal/src/app/portal/roles/components/wizards/wizard-steps/types.ts
@apps/portal/src/app/portal/roles/components/wizards/wizard-steps/step-2-compensation.tsx
@apps/portal/src/app/portal/roles/components/modals/role-wizard-modal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend FormData type and add form controls to Step 2</name>
  <files>
    apps/portal/src/app/portal/roles/components/wizards/wizard-steps/types.ts
    apps/portal/src/app/portal/roles/components/wizards/wizard-steps/step-2-compensation.tsx
  </files>
  <action>
    1. In types.ts, add to the FormData interface under Step 2 (after open_to_relocation):
       - `commute_types: string[];` (array of selected commute type values)
       - `job_level: string;` (single selected job level value, empty string for unset)

    2. In step-2-compensation.tsx, add TWO new fieldsets after the "Employment Type" fieldset and before the "Additional Options" fieldset:

       a) Commute Type fieldset with checkbox group:
          - Legend: "Commute Type"
          - 6 checkboxes in a flex-wrap layout, each with a label:
            - `remote` -> "Remote"
            - `hybrid_1` -> "Hybrid (1 day in office)"
            - `hybrid_2` -> "Hybrid (2 days in office)"
            - `hybrid_3` -> "Hybrid (3 days in office)"
            - `hybrid_4` -> "Hybrid (4 days in office)"
            - `in_office` -> "In Office"
          - Use DaisyUI checkbox styling: `className="checkbox checkbox-sm"`
          - Each checkbox toggles its value in/out of the `formData.commute_types` array
          - onChange handler: if checked, add value to array; if unchecked, filter it out
          - Use `formData.commute_types.includes(value)` for checked state

       b) Job Level fieldset with single-select dropdown:
          - Legend: "Job Level"
          - `<select className="select w-full">` with options:
            - `""` -> "Select Level" (default empty)
            - `entry` -> "Entry Level"
            - `mid` -> "Mid Level"
            - `senior` -> "Senior"
            - `lead` -> "Lead"
            - `manager` -> "Manager"
            - `director` -> "Director"
            - `vp` -> "VP"
            - `c_suite` -> "C-Suite"
          - onChange sets formData.job_level

    Define the commute type options as a const array at the top of step-2-compensation.tsx:
    ```typescript
    const COMMUTE_TYPE_OPTIONS = [
        { value: 'remote', label: 'Remote' },
        { value: 'hybrid_1', label: 'Hybrid (1 day in office)' },
        { value: 'hybrid_2', label: 'Hybrid (2 days in office)' },
        { value: 'hybrid_3', label: 'Hybrid (3 days in office)' },
        { value: 'hybrid_4', label: 'Hybrid (4 days in office)' },
        { value: 'in_office', label: 'In Office' },
    ] as const;

    const JOB_LEVEL_OPTIONS = [
        { value: 'entry', label: 'Entry Level' },
        { value: 'mid', label: 'Mid Level' },
        { value: 'senior', label: 'Senior' },
        { value: 'lead', label: 'Lead' },
        { value: 'manager', label: 'Manager' },
        { value: 'director', label: 'Director' },
        { value: 'vp', label: 'VP' },
        { value: 'c_suite', label: 'C-Suite' },
    ] as const;
    ```
  </action>
  <verify>Run `pnpm --filter @splits-network/portal build` and confirm zero type errors related to FormData or Step2Compensation.</verify>
  <done>FormData has commute_types (string[]) and job_level (string) fields. Step 2 renders 6 checkboxes for commute type and an 8-option dropdown for job level.</done>
</task>

<task type="auto">
  <name>Task 2: Wire form state in role-wizard-modal (init, edit load, reset, payload)</name>
  <files>
    apps/portal/src/app/portal/roles/components/modals/role-wizard-modal.tsx
  </files>
  <action>
    Update role-wizard-modal.tsx in 4 places:

    1. **Initial formData state** (~line 47): Add to Step 2 section:
       ```
       commute_types: [],
       job_level: '',
       ```

    2. **Edit mode loading** (~line 115, inside setFormData in loadJobData): Add:
       ```
       commute_types: job.commute_types || [],
       job_level: job.job_level || '',
       ```

    3. **Reset form** (~line 277, inside setFormData in isOpen effect): Add:
       ```
       commute_types: [],
       job_level: '',
       ```

    4. **Build payload** (~line 339, in handleSubmit): Add after the `guarantee_days` line:
       ```typescript
       if (formData.commute_types.length > 0) payload.commute_types = formData.commute_types;
       if (formData.job_level) payload.job_level = formData.job_level;
       ```
       This sends the fields only when set (null/empty values won't override existing data on edit unless explicitly set).
  </action>
  <verify>Run `pnpm --filter @splits-network/portal build` and confirm zero errors. Grep for "commute_types" in role-wizard-modal.tsx to confirm it appears in all 4 locations (init, edit load, reset, payload).</verify>
  <done>Role wizard modal initializes commute_types=[] and job_level='', populates them from API on edit, resets them on modal open, and includes them in create/update payload.</done>
</task>

</tasks>

<verification>
- `pnpm --filter @splits-network/portal build` passes with zero errors
- FormData interface in types.ts includes commute_types and job_level
- step-2-compensation.tsx renders checkboxes and dropdown
- role-wizard-modal.tsx references commute_types in init, edit load, reset, and payload
</verification>

<success_criteria>
- Job create/edit wizard Step 2 shows commute type checkboxes (6 options) and job level dropdown (8 options)
- Form state is properly initialized, loaded from API on edit, reset on close, and included in submission payload
- Portal build passes without type errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-frontend-and-search/10-01-SUMMARY.md`
</output>
