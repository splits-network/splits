---
phase: 02-visual-redesign
plan: 03
type: execute
wave: 3
depends_on: ["02-02"]
files_modified:
    - apps/portal/src/app/pricing/pricing-content.tsx
autonomous: true

must_haves:
    truths:
        - "Feature comparison table rows reveal progressively on scroll"
        - "Table header row animates first, then data rows stagger in"
        - "Pro column gets subtle highlight animation after rows appear"
    artifacts:
        - path: "apps/portal/src/app/pricing/pricing-content.tsx"
          provides: "Animated feature comparison table"
          contains: "comparison-row"
    key_links:
        - from: "pricing-content.tsx"
          to: "animation-utils.ts"
          via: "stagger.tight for row animations"
          pattern: "stagger\\.tight"
---

<objective>
Add scroll-triggered animations to the feature comparison table with progressive row reveals.

Purpose: The comparison table is dense information - animating rows draws attention and makes scanning easier. Highlighting the Pro column reinforces the recommended choice.
Output: Table rows that stagger in on scroll with Pro column highlight.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-visual-redesign/02-02-SUMMARY.md
@apps/portal/src/app/pricing/pricing-content.tsx
@apps/portal/src/components/landing/sections/comparison-section.tsx
@apps/portal/src/components/landing/shared/animation-utils.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add row stagger animations to comparison table</name>
  <files>apps/portal/src/app/pricing/pricing-content.tsx</files>
  <action>
Add scroll-triggered animations to the feature comparison table rows.

Implementation:

1. Create new refs:
    - `tableSectionRef` for the "Feature Comparison" section (the one with `py-20 bg-base-100`)
    - `tableRef` for the `<table>` element itself

2. Add CSS class `comparison-row` to each `<tr>` element in the table (header row and all data rows)

3. Add `opacity-0` class to each `<tr>` element for initial hidden state

4. Add new useGSAP block for table animations:

    ```typescript
    useGSAP(
        () => {
            if (!tableSectionRef.current) return;

            const prefersReducedMotion = window.matchMedia(
                "(prefers-reduced-motion: reduce)",
            ).matches;
            if (prefersReducedMotion) return;

            // Header animation first
            const rows = tableRef.current?.querySelectorAll(".comparison-row");
            if (rows) {
                gsap.fromTo(
                    rows,
                    { opacity: 0, x: -20 },
                    {
                        opacity: 1,
                        x: 0,
                        duration: duration.fast,
                        ease: easing.smooth,
                        stagger: stagger.tight,
                        scrollTrigger: {
                            trigger: tableRef.current,
                            start: "top 75%",
                        },
                    },
                );
            }
        },
        { scope: tableSectionRef },
    );
    ```

Pattern follows comparison-section.tsx with slideFromLeft effect and tight stagger for fast row reveals.
</action>
<verify>

1. Build check: `pnpm --filter @splits-network/portal build` passes
2. Visual test: Scroll to comparison table - rows should slide in from left with tight stagger
3. Header row should animate first, then data rows follow quickly
   </verify>
   <done>
   All comparison table rows animate in with slideFromLeft effect and tight stagger timing. Animation triggers when table enters viewport.
   </done>
   </task>

<task type="auto">
  <name>Task 2: Add Pro column highlight animation</name>
  <files>apps/portal/src/app/pricing/pricing-content.tsx</files>
  <action>
Add a subtle background highlight animation to the Pro column cells after rows have appeared.

Implementation:

1. Add CSS class `pro-cell` to all Pro column `<td>` and `<th>` cells (the ones that already have `bg-primary/10`)

2. In the table useGSAP block, after the row animation, add Pro column highlight:
    ```typescript
    // Pro column highlight pulse - runs after rows are visible
    const proCells = tableRef.current?.querySelectorAll(".pro-cell");
    if (proCells) {
        gsap.fromTo(
            proCells,
            { backgroundColor: "rgba(var(--p) / 0)" },
            {
                backgroundColor: "rgba(var(--p) / 0.1)",
                duration: 0.5,
                delay: 0.6, // Wait for row animations to mostly complete
                ease: easing.smooth,
                scrollTrigger: {
                    trigger: tableRef.current,
                    start: "top 75%",
                },
            },
        );
    }
    ```

Note: The `rgba(var(--p) / 0.1)` uses DaisyUI's CSS variable for primary color. If this doesn't work in GSAP, fall back to explicit color like the landing page does: `rgba(15, 157, 138, 0.1)` or use the theme's primary color value.

Alternative if CSS variable doesn't work:

```typescript
gsap.fromTo(
    proCells,
    { backgroundColor: "transparent" },
    {
        backgroundColor: "oklch(var(--p) / 0.1)",
        duration: 0.5,
        delay: 0.6,
        ease: easing.smooth,
        scrollTrigger: {
            trigger: tableRef.current,
            start: "top 75%",
        },
    },
);
```

If neither works, use a solid hex value matching the primary color at 10% opacity.
</action>
<verify>

1. Build check: `pnpm --filter @splits-network/portal build` passes
2. Visual test: After rows animate in, Pro column should get subtle background highlight
3. Highlight should feel like a "glow" drawing attention to recommended plan
   </verify>
   <done>
   Pro column cells receive subtle background highlight animation after rows have appeared. The highlight draws attention to the recommended plan.
   </done>
   </task>

<task type="auto">
  <name>Task 3: Final polish and cohesion check</name>
  <files>apps/portal/src/app/pricing/pricing-content.tsx</files>
  <action>
Review all animations for cohesion and add any missing polish.

Checklist:

1. Verify all animated elements have `opacity-0` initial class
2. Ensure reduced motion check is in each useGSAP block
3. Verify animation timing feels cohesive:
    - Hero: duration.hero for headline, duration.normal for subtitle
    - Cards: duration.normal with stagger.normal
    - Counters: duration.counter (1.5s)
    - Table: duration.fast with stagger.tight
4. Add section header animation to "Feature Comparison" heading if missing:
    ```typescript
    // Heading animation
    gsap.fromTo(
        tableHeadingRef.current,
        { opacity: 0, y: 30 },
        {
            opacity: 1,
            y: 0,
            duration: duration.normal,
            ease: easing.smooth,
            scrollTrigger: {
                trigger: tableSectionRef.current,
                start: "top 80%",
            },
        },
    );
    ```
5. Add similar heading animations to "For Companies" section header if not already present
6. Consider adding CTA section animation (the final "Ready to Start" section) with fadeUp pattern

Ensure:

- No duplicate ScrollTrigger registrations (only register once at top)
- All refs are properly typed as `useRef<HTMLElement>(null)` or appropriate element type
- No TypeScript errors
  </action>
  <verify>

1. Build check: `pnpm --filter @splits-network/portal build` passes without errors
2. Visual test: Scroll through entire page - animations should feel cohesive
3. Animation timing should match landing page feel (not too slow, not too fast)
4. All sections have scroll-triggered reveals
5. Page loads fast, no jank from animations
   </verify>
   <done>
   All pricing page sections have cohesive scroll-triggered animations matching landing page timing and easing. No TypeScript errors. Reduced motion properly respected throughout.
   </done>
   </task>

</tasks>

<verification>
1. `pnpm --filter @splits-network/portal build` completes without errors
2. Full page scroll-through shows cohesive animation experience
3. Table rows stagger in smoothly from left
4. Pro column gets subtle highlight after rows appear
5. All section headings animate on scroll
6. CTA section animates on scroll
7. Reduced motion disables all animations
8. No console warnings about ScrollTrigger
</verification>

<success_criteria>

- Table rows have `.comparison-row` class and animate with slideFromLeft
- Pro column cells have `.pro-cell` class and receive highlight animation
- All section headings animate with fadeUp on scroll
- Animation timing hierarchy: fast for dense content (table), normal for key content (cards), hero for emphasis (headline)
- Consistent use of animation-utils presets throughout
- All animations respect prefers-reduced-motion
- Page feels visually cohesive with landing page
- Build passes with no TypeScript errors
  </success_criteria>

<output>
After completion, create `.planning/phases/02-visual-redesign/02-03-SUMMARY.md`
</output>
